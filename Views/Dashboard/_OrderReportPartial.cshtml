@model List<POSRestoran01.Models.ViewModels.DashboardViewModels.OrderReportViewModel>

@if (Model.Any())
{
    <table class="min-w-full">
        <thead class="sticky top-0 bg-white z-10">
            <tr class="border-b border-gray-200">
                <th class="text-left py-2 px-2 font-semibold text-gray-700 text-sm">Customer</th>
                <th class="text-left py-2 px-2 font-semibold text-gray-700 text-sm">Menu</th>
                <th class="text-left py-2 px-2 font-semibold text-gray-700 text-sm">Total</th>
                <th class="text-left py-2 px-2 font-semibold text-gray-700 text-sm">Status</th>
                <th class="text-left py-2 px-2 font-semibold text-gray-700 text-sm">Aksi</th>
            </tr>
        </thead>
        <tbody>
            @foreach (var order in Model)
            {
                <tr class="border-b border-gray-100 hover:bg-gray-50">
                    <td class="py-2 px-2">
                        <div>
                            <div class="font-medium text-sm">@(order.CustomerName ?? "Guest")</div>
                            <div class="text-xs text-gray-500">@order.OrderNumber</div>
                            <div class="text-xs text-gray-400">@order.OrderDate.ToString("dd/MM/yyyy") @order.OrderTime.ToString(@"hh\:mm")</div>
                        </div>
                    </td>
                    <td class="py-2 px-2">
                        <div class="text-xs text-gray-600 truncate max-w-xs">@order.MenuSummary</div>
                        <div class="text-xs text-gray-400">@order.OrderType @(order.TableNo.HasValue ? $"- Table {order.TableNo}" : "")</div>
                    </td>
                    <td class="py-2 px-2 font-semibold text-sm">@order.Total.ToString("C", new System.Globalization.CultureInfo("id-ID"))</td>
                    <td class="py-2 px-2">
                        @{
                            var statusClass = order.Status switch
                            {
                                "Pending" => "bg-yellow-100 text-yellow-800",
                                "Preparing" => "bg-blue-100 text-blue-800",
                                "Completed" => "bg-green-100 text-green-800",
                                "Canceled" => "bg-red-100 text-red-800",
                                _ => "bg-gray-100 text-gray-800"
                            };
                        }
                        <span class="px-2 py-1 text-xs rounded-full @statusClass">@order.Status</span>
                    </td>
                    <td class="py-2 px-2">
                        <div class="flex space-x-1">
                            <select onchange="updateOrderStatus(@order.OrderId, this.value)"
                                    class="text-xs border rounded px-1 py-1"
                                    style="font-size:10px;">
                                <option value="">Ubah</option>
                                @if (order.Status != "Pending")
                                {
                                    <option value="Pending">Pending</option>
                                }
                                @if (order.Status != "Preparing")
                                {
                                    <option value="Preparing">Preparing</option>
                                }
                                @if (order.Status != "Completed")
                                {
                                    <option value="Completed">Completed</option>
                                }
                                @if (order.Status != "Canceled")
                                {
                                    <option value="Canceled">Canceled</option>
                                }
                            </select>

                            <button onclick="showOrderDetail(@order.OrderId)"
                                    class="text-blue-600 hover:text-blue-800 text-xs px-1"
                                    title="Lihat Detail">
                                <i class="fas fa-eye"></i>
                            </button>

                            @if (order.Status == "Completed")
                            {
                                <button onclick="@(order.Status == "Completed" ? $"printReceipt({order.OrderId}, true)" : "return false;")"
                                        class="@(order.Status == "Completed" ? "text-green-600 hover:text-green-800" : "text-gray-400 cursor-not-allowed") text-xs px-1"
                                        title="@(order.Status == "Completed" ? "Cetak Struk" : "Order belum completed")"
                                        @(order.Status != "Completed" ? "disabled" : "")>
                                    <i class="fas fa-print"></i>
                                </button>
                            }
                        </div>
                    </td>
                </tr>
            }
        </tbody>
    </table>
}
else
{
    <div class="text-center py-8 text-gray-500">
        <i class="fas fa-receipt text-2xl mb-2"></i>
        <p class="text-sm">Tidak ada data order</p>
    </div>
}